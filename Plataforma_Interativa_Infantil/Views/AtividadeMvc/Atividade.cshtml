@using backend.ViewModels
@using backend.Models
@model backend.ViewModels.ResponderAtividadeViewModel
@using System.Text.Json

@{
    ViewData["Title"] = "Quiz: " + Model.Titulo;
    Layout = null; // Esta página não usa o layout principal
    // Serializa os dados do quiz para o JavaScript
    var quizDataJson = JsonSerializer.Serialize(Model, new JsonSerializerOptions { PropertyNamingPolicy = JsonNamingPolicy.CamelCase });
}

<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - CogniVerse</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/quiz.css" asp-append-version="true" />
</head>
<body class="quiz-body">
    @* Passa os dados do quiz para o JavaScript *@
    <div id="quiz-data-container" data-quiz='@quizDataJson' style="display:none;"></div>
    @* Passa o token anti-falsificação para o JavaScript *@
    <form id="quiz-form-token" style="display:none;">@Html.AntiForgeryToken()</form>

    <header class="quiz-header">
        <a href="@Url.Action("Index", "Crianca")" class="btn-sair"><i class="bi bi-arrow-left"></i> Sair</a>
        <span class="quiz-title">@Model.Titulo</span>
    </header>

    <main class="quiz-main-content">
        @* Tela principal do Quiz (Questões) *@
        <div id="quiz-active-screen">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="progress-text">Questão 1 de 5</span>
                    <span id="progress-percent">20%</span>
                </div>
                <div class="progress">
                    <div id="progress-bar" class="progress-bar" role="progressbar" style="width: 20%;"
                         aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
            </div>

            <div class="quiz-card">
                <p id="pergunta-texto" class="pergunta-texto">Quanto é 7 + 8?</p>
                <div id="feedback-box" class="feedback-box hidden"></div>
                <div id="alternativas-grid" class="alternativas-grid">
                    @* As alternativas serão inseridas aqui pelo quiz.js *@
                </div>
                <button id="btnProxima" class="btn-proxima hidden">Próxima Questão</button>
            </div>
        </div>

        @* Tela de Resultados (escondida por padrão) *@
        <div id="final-screen" class="hidden">
            <div class="resultado-card">
                <div class="trophy-icon"><i class="bi bi-trophy"></i></div>
                <h3 class="parabens-texto">Parabéns!</h3>
                <p class="text-muted">Você completou a atividade de @Model.Titulo</p>
                <div id="feedback-final" class="feedback-final">Muito bem! Continue assim!</div>
                <div class="stats-grid">
                    <div class="stat-item"><i class="bi bi-star-fill"></i> Questões Corretas <span id="acertos-finais">3/5</span></div>
                    <div class="stat-item"><i class="bi bi-trophy-fill"></i> Nota <span id="nota-final">60%</span></div>
                    <div class="stat-item"><i class="bi bi-clock-fill"></i> Tempo <span id="tempo-final">32s</span></div>
                </div>
                <a href="@Url.Action("Index", "Crianca")" class="btn-dashboard">Voltar ao Dashboard</a>
            </div>
        </div>
    </main>

    @* Scripts para o Quiz *@
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="~/js/quiz.js" asp-append-version="true"></script>
</body>
</html>